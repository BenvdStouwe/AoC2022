namespace AoC2022;

public class Day2
{
    private const string TestInput = @"A Y
B X
C Z";

    private static readonly IReadOnlyDictionary<char, short> Values = new Dictionary<char, short> { ['X'] = 1, ['Y'] = 2, ['Z'] = 3 };

    [Theory]
    [InlineData(TestInput, 15)]
    [InlineData(RealInput, 13924)]
    public void Test1(string input, int expectedResult)
    {
        var result = SolvePart1(input);

        Assert.Equal(expectedResult, result);
    }

    [Theory]
    [InlineData(TestInput, 12)]
    [InlineData(RealInput, 13448)]
    public void Test2(string input, int expectedResult)
    {
        var result = SolvePart2(input);

        Assert.Equal(expectedResult, result);
    }

    private static int SolvePart1(string input) =>
        ParseInput(input)
            .Select(CalculateScore)
            .Sum();

    private static int SolvePart2(string input) =>
        ParseInput(input)
            .Select(r => (r.Item1, DetermineMyChoice(r.Item1, r.Item2)))
            .Select(CalculateScore)
            .Sum();

    private static IEnumerable<(char, char)> ParseInput(string input) =>
        input.Split(Environment.NewLine)
            .Select(i => (i[0], i[2]));

    private static int CalculateScore((char other, char mine) pair) =>
        pair.other switch
        {
            'A' => pair.mine switch
            {
                'X' => 3,
                'Y' => 6,
                _ => 0
            },
            'B' => pair.mine switch
            {
                'Y' => 3,
                'Z' => 6,
                _ => 0
            },
            _ => pair.mine switch
            {
                'Z' => 3,
                'X' => 6,
                _ => 0
            }
        } + Values[pair.mine];

    private static char DetermineMyChoice(char other, char result) =>
        other switch
        {
            'A' => result switch
            {
                'X' => 'Z',
                'Y' => 'X',
                _ => 'Y'
            },
            'B' => result switch
            {
                'X' => 'X',
                'Y' => 'Y',
                _ => 'Z'
            },
            _ => result switch
            {
                'X' => 'Y',
                'Y' => 'Z',
                _ => 'X'
            }
        };

    private const string RealInput = @"A Z
C Z
A X
B Z
C X
A X
A X
A Z
C Y
A X
C Z
C Y
B Z
B X
A X
B X
C X
C X
C Z
B Z
B Y
C X
C X
C Z
C X
C X
C X
A Y
B Y
C Y
C Z
B Y
B X
C Z
B Z
B Y
B Y
C Z
C X
C Y
B Z
B Z
A X
A X
C Z
C X
A X
B Z
C X
C X
B Z
B Z
C Z
A X
A X
A Z
C Z
C Z
C Z
A X
B Z
A X
B Y
C Z
C X
B Z
C X
C Y
B Z
A X
B Z
A Z
C X
B Z
C Z
C X
C Z
C X
C Z
C Y
C Z
C Y
C X
C Z
C Z
C Z
C Z
A X
B Z
B X
C X
C Z
C Z
A Y
C Z
C X
B Y
B Z
C Z
C X
B Z
A Z
C Z
C Z
C Z
C Z
C Z
B X
A X
B Z
B Y
B Z
C X
C Y
B Z
A X
A X
A Z
C X
C Z
B Z
C Z
C X
A X
A X
A X
C Z
B Z
A Z
C Z
C X
B Z
B Z
C X
B X
C X
C X
C X
B Z
C X
B Z
A X
A Z
A Z
C Z
C Y
C Z
B Y
C Z
C Z
C X
C X
A X
C Z
A Z
B Z
A X
C Z
C Z
B Z
A Z
C X
B Z
C Z
C X
C Y
C Y
B Y
B Z
C Y
C Z
B Z
C Z
B Z
C X
A X
B X
C Y
B Z
C Z
B X
A X
C Z
C Z
C Z
C X
B Y
A X
C Y
C Z
B X
A Z
C Z
C X
B Y
A Y
C Z
C Z
B Y
A X
A Z
B Y
C Z
B X
C Z
C Z
B X
C Z
C X
A X
C Z
A X
C X
B Z
C Y
C Z
A Z
B Z
A X
A X
C X
A Y
C Y
C X
C Z
C Z
C Z
C Z
C Z
B Y
A X
A Z
B Y
C Z
C X
C X
B Z
C X
A Z
A X
C Z
B X
B Z
A Z
B X
A X
A X
B Z
B Y
B Y
C X
C Z
C Z
C Y
C X
C Z
C Z
B X
A X
B X
C X
C X
B Z
B Z
C X
C X
B Z
B Z
A Z
B Z
B Z
C Z
A Z
A Z
C X
B Z
A X
C X
A X
C Z
A X
C Z
B X
C X
B Z
A Y
C Z
B X
C Y
C X
B Z
C Y
C Z
B X
B X
B Z
C X
C Z
B Z
C Z
C X
A X
A X
C Y
B X
A Z
B Y
C X
B Y
C Z
B Y
B Z
C Y
C Z
A Z
C X
C X
C X
C Z
A Y
A Z
C Z
C Z
B Z
B Z
B Z
A Z
C Z
C X
C Z
C Z
A X
C Z
C X
B X
C Z
C X
C Z
A X
B X
C Z
C X
B Z
C Y
A Y
A X
C X
A X
B X
C X
C Z
A Z
C Z
C Z
B Z
A X
C Z
C Z
C Z
B Z
A X
C Z
C Z
C Z
C Z
B Y
C X
B Z
C Z
B X
C Z
C X
C Y
B X
A Y
A Y
C Y
B Y
C X
B Y
C X
A X
C Z
C X
C X
B Z
C X
B Z
C Z
C Z
A X
B Y
C X
C Z
B X
C Z
C Y
B Z
A X
B Z
B Z
B X
A Z
A X
C Z
A Y
A X
A X
C Y
B Y
C X
B Y
B X
A X
C Y
A X
B Z
B Y
B Y
A X
A X
A Z
C X
A X
C Y
A X
A X
C Y
C Z
B Z
B Y
B X
A X
A X
B Z
C Z
B X
A Y
A Z
C Y
A X
C Z
C X
A Z
C Z
C Z
C Y
C X
C Z
A Z
C Y
C Z
C Z
C Z
C X
C Z
A X
C Y
B Y
C Y
B Y
A X
B Y
B Z
B Z
B X
B Z
C Z
B Z
C Z
B X
C Z
B Z
B Z
C Z
C Z
A Z
A Z
C X
B Y
B Y
C Z
C X
C Z
A Z
A X
C Y
C Z
B Z
C Z
A X
B Z
A X
A Z
A X
A X
C X
B Z
B Z
C Z
C X
A X
B X
A X
A X
A Z
C Y
B Y
B X
A X
C X
B Y
C Z
B X
C X
B Z
B Z
C Z
B Z
C Z
C Y
C Y
A X
A Z
C X
A X
C Z
A Z
B X
C X
A X
B Z
B Z
B Z
C Z
C Z
C Z
C Y
B Z
C X
C X
C X
B Z
B Z
B Z
A X
A X
A Z
C Z
C X
A X
B X
A Z
C X
A X
C Z
C Z
C Z
C Z
C Y
C Z
B Z
C X
C Z
A Z
A Z
B Z
C X
A X
A X
A X
C X
C X
C X
C X
B X
C X
B Y
C Z
C Z
C Z
B Z
B Z
C Z
B Y
C Y
C X
A Z
C Y
C Z
A X
C X
C Z
C Z
A X
C Y
B Y
C X
C Z
C X
B X
C Z
B Z
B Y
A X
C X
C Z
B Z
B X
A Z
C Y
C X
C Y
B Z
A Z
C X
C X
A X
A Y
B Y
C Y
C Z
C Z
C Z
C Y
A X
A X
B X
B Y
A Z
C Z
C Y
B Z
C Z
C X
C Z
A X
C Z
C X
C Y
C X
C X
C X
C Z
C Z
C Z
A X
C Z
C X
C X
B X
C X
B Y
A X
C X
A X
C Y
C X
C Z
C X
C Z
C X
B Z
A X
C Z
C X
C Z
C Y
C X
C X
C Z
B Z
C Z
C Z
C X
B Z
C Z
B X
C Z
B Z
C X
B X
C Z
C Y
B X
C Z
C Y
A X
B Z
B Z
C Y
B Y
B X
C Y
C X
C X
B Z
B Y
C X
C Z
B Z
C Y
C X
C Z
C Y
B Z
A Z
C Z
C Z
C Z
C Y
C Z
C Z
C Z
C X
B Z
B Z
C Z
C X
C X
C Z
C Z
C X
A Z
B Z
B X
C X
C Z
A Z
C X
C Z
B Z
A X
C Z
C Z
B Z
C Z
B Y
A X
A X
A Z
B Z
A Z
A X
B Z
C X
B Z
B Z
B Y
A X
B X
B Z
B Z
A X
C Z
B Z
C X
A X
B Z
B Z
C Z
B Y
C Z
B Z
B Y
C X
A Z
B Y
A X
A X
C X
C Z
A Z
C X
C Z
A Z
B Z
C Z
C Z
C X
C Y
C Z
A X
C X
C Z
B Y
B Z
A X
C X
B Z
C X
B Z
C Z
C Y
C Z
B Z
C X
A Z
C Z
C Z
B Z
B X
A Z
C Z
C Z
C Z
C Z
A Z
C X
B Z
C Y
B X
C Z
A X
B Y
C Z
B X
B X
C X
A Z
C X
C X
C Z
A Y
C Y
C Z
B Z
A X
B Z
C Z
A Z
C Y
B Z
B Z
C X
C Z
A Z
C X
C X
C Z
C Z
C Z
A X
C Z
A X
C Z
C X
C Z
C Z
C X
A Z
B Y
B Z
A X
C Y
C Z
B Z
B Z
A X
B Z
A Z
C Z
C Z
A X
C X
A Y
C Z
C X
C Z
B Y
C Y
B Z
B Z
A X
C Z
C Z
A Z
A X
C Z
C Z
C Y
C Z
A X
B Z
A X
B Y
C X
B Z
C X
B X
A X
B Y
A Y
C X
B Y
B Y
B Z
C Z
A Z
B Z
A X
C Z
C Z
A X
B Z
A X
A X
B Y
B Z
A Y
C Z
C X
A X
C Z
A Z
C Y
B Z
C X
C Y
B Z
B X
A X
C Z
C X
A Z
A Z
C Z
A Z
C Z
C Z
C Z
A Z
A Z
C Z
C Z
A X
B X
B Z
C X
A Y
C Z
C Z
B Z
C Z
C Z
C X
A X
A Z
C X
B Z
C X
C Z
C X
A X
B X
C X
B Z
C X
A Z
C Z
B X
C Z
B Y
A X
C Z
C X
C X
C Z
B Z
C X
C Z
A X
A X
C X
B Z
C Z
B Z
A Z
C Z
A Z
C Z
C Y
A Z
A X
B Y
A X
B X
C X
C Z
C Y
C X
C Z
C X
C X
B X
B Z
B Y
C Y
C Z
C X
C Y
C X
C X
C Z
C Y
C X
C X
C Z
C X
C Y
C Z
B X
A Y
C X
B X
A Z
C Z
C X
C Y
B X
C Z
A X
B Z
B Z
A X
A X
B Z
B Z
A Z
A X
B X
C Y
A Z
C Z
B Z
A X
B X
B Z
A X
A Z
C Y
B X
B Y
C Z
C X
A Z
C Z
C Z
C Z
B Y
B X
A Z
B Y
A X
A Z
B Z
C X
A X
C X
B Y
A Z
C X
C X
A X
A X
A X
C X
B Z
B Z
C Z
C Z
A X
B Z
C Z
B Z
C X
B Y
C Z
A X
C Z
A X
A Z
C Z
B Z
C Z
B Y
A X
C Z
B Z
C X
C Z
C Z
C Z
C Y
C X
C Y
B Y
B Z
C Z
B X
C Z
C X
A X
C Z
B Y
C Y
C Z
B Z
C X
C Z
C Z
C Z
C X
A Y
B Y
C Y
A X
A Z
C Z
B Z
C Z
B Z
A X
A X
C Z
C X
B Z
B Z
A Z
C Z
A Z
C Y
B X
C Z
A X
B Y
A X
C Z
C Z
A Z
A Z
A X
C Z
B Z
C Z
B Y
A X
C Z
B Z
B Z
A X
A X
C X
B X
B X
B Z
A Z
C Z
C X
C Y
B Z
C X
A X
C Z
C Z
C Z
C Z
B Y
C Z
B Z
C Z
B X
C Z
C X
A X
B Y
C Z
C Z
A X
B Y
B Y
B Y
B Z
A X
B Z
B Z
A X
C Z
C Z
C Z
B Z
B Z
A X
C Z
C Z
C X
C Z
C Z
C Z
C Y
A Z
C X
C Y
C X
B Z
A X
C Z
C X
A Z
A Z
C Z
B Z
B Z
C X
B Z
C X
B Z
C X
C X
B Y
C Z
C Y
B Z
C X
C Z
C X
C X
C X
A X
C Y
C X
A X
B Z
A Z
C Z
C X
C X
C Z
B Z
C X
C Z
A Z
B Z
C Z
C X
C Z
C Z
A Z
C Z
A X
C Z
A Z
C Z
A X
B Y
C X
A X
C Z
B Z
A X
B Y
A Z
C Z
C Z
B Y
A X
B Z
A X
B Z
C Z
C X
B Z
C Z
B Z
C X
B Y
B X
C Y
A Z
C Y
C X
C Y
C X
C X
A Z
B Z
A Z
A X
A X
A X
C X
C Z
A X
B X
A X
C X
B Z
C Z
C Y
A Z
C X
C Z
B Y
B Z
A X
A Z
C Z
C X
B Y
A X
B Y
C Y
A X
A Z
B Z
C Z
C Z
A Z
C Z
C X
C Y
C X
C X
C Y
A X
C Z
C X
C Z
C Z
A Z
C Z
C Z
C Y
C Z
B Y
C Z
C Z
C Z
C Z
C X
A X
C Z
C Z
C X
C Z
C X
C Z
A X
A Z
B Z
B Y
A X
C X
C Y
A X
B X
C X
C X
A Z
C X
C Y
B X
C Z
A Z
C X
A X
B Z
C Y
C Z
C X
A Y
C Z
C Y
C Z
C Z
B Z
B Z
B Z
C Z
C Z
A X
B X
A X
B Y
B Z
B Z
C X
C X
C Z
A Z
A X
B X
B Z
B Z
A X
C Z
B Z
B Z
C Z
C Z
C Z
B Z
C X
C X
B Z
C Y
B Z
C X
B X
C X
A Z
A X
C Z
C Z
B Y
A X
A Y
C Z
A Z
C X
B Y
C X
A Z
B Y
B X
C Z
C X
B Y
C Z
B Z
C X
C X
C Z
B Z
C Z
C Z
C X
C X
C Z
C X
C X
C Z
A X
C X
C X
B Z
C Z
A X
C X
C X
A Z
C Z
C Z
B Y
B Z
B X
C Z
A X
A X
B Y
C X
C X
B Y
C Z
A Z
B Y
B Y
C X
C X
C X
C X
A X
B Z
B Y
B Z
C X
C Z
B Z
B Y
C Z
B Z
A X
C X
C X
C Z
A X
C X
C X
C Z
C Y
B X
C X
C Y
B Z
C X
C Y
C Z
C Z
A Z
B X
C Z
B X
A Z
C Z
C X
C X
A Z
C X
B Z
A Z
C X
C X
B X
C Z
C X
A X
C Z
C Z
B Z
B Y
C X
C Y
C Z
C Z
A Z
C Z
C Y
C Y
A X
C Z
A X
B Z
B Z
C Z
B X
B Z
A Z
A Z
B Z
B Y
B Z
C X
B Y
B Z
A X
B X
C Y
A X
C Z
B Z
C X
A X
B X
C Y
B Z
C Z
A X
C X
B Z
C X
A Z
C X
C Z
C Z
B X
C X
A Z
C X
B Z
C Z
C Z
C X
B Z
C Z
B X
C X
C Z
B Z
B Z
A X
C X
C Z
C Z
C Z
A X
C X
C Z
B Z
C Y
C X
C X
C Z
C X
C Z
C X
C X
C Z
B Z
B Z
C Z
B Z
C Z
B X
C Z
A X
C Z
C X
C X
C Z
B Y
B Z
B Z
B Z
C Z
B X
C X
B Z
A X
C X
A X
C X
C X
A Z
B Y
B X
A X
C Z
B Y
C X
A X
B Z
B Z
C Z
B Z
C Z
A Y
A Z
C X
C Y
A Y
C X
B Y
C X
C Y
C Z
B Z
C Z
B Z
B X
C Z
B X
B X
C Z
A Z
B Z
C Z
B Z
C Z
C Z
B Z
C X
C Z
C Z
C Z
C Z
A Z
C Z
B Z
B Z
B Z
C Z
C Z
C Z
A X
B X
C Z
A X
C X
B Z
C X
C Z
B Y
C Z
C Z
A X
C Z
C X
C X
C X
B Z
C Y
C Z
B Z
A X
C X
C X
C X
C Z
A Z
A Z
B Y
B Z
B Z
C X
A X
C X
C X
A X
B X
B Z
B Z
C X
C Z
C Z
C X
B X
A X
A Z
C X
C Z
B Z
B Y
C Z
A X
B X
B Z
C Z
C Y
C Z
C X
C Z
C Z
B Z
C Y
C X
A X
B Z
C Y
A Z
C Z
B Y
A X
A Z
A X
C Z
C Y
C Z
C Y
A Z
B Z
B Z
C Z
C Z
C X
C Z
C Y
C Z
C Z
B Y
A X
B Z
C Z
C X
C X
A Z
B Z
B Z
B Y
B Z
C Y
B Z
C Z
A X
C X
C X
B X
C Z
A X
C Y
B X
C Z
C Z
B Y
C Z
B Y
C Z
A Z
C Z
B Y
A X
C X
C X
C Z
C X
C Z
B Y
B Z
C Z
B Z
C Z
A X
B Z
C X
C Y
A Z
B Z
C X
A Z
C Y
B Y
C Y
C Z
C Z
A Z
A Z
C X
B Y
C Z
B Z
A X
B Z
A X
C X
C Z
B Z
C X
B Z
C X
A Y
C Z
B Z
C X
C X
C X
B X
B Y
A Y
B Z
A X
C X
C Z
B Y
C Z
C Z
B X
B X
A Y
C X
C Z
C X
C Z
C X
C X
C Z
C Z
C X
A X
C Z
B Z
B X
A X
B X
A Z
B X
C Z
C Z
A Z
C X
C X
A X
C Z
C X
C Z
C X
C X
C Z
A Z
C Z
A Z
C Z
B Z
C Z
C Y
C X
C Z
B Z
B Z
C Y
B Y
C X
C Y
A Z
A X
A X
A Z
C X
C X
C Z
C Z
B Z
C Z
A X
C Z
C X
B Z
A X
C Z
C Z
B Z
B Z
B X
B Z
A X
C Z
B Z
A Z
C X
C X
A Z
C Y
B Y
C X
B Z
C X
C Z
B Y
A Y
B Y
A X
C Y
C X
C Z
A X
A Z
B Z
B Y
C Y
B Z
A Y
B X
C Z
C Z
C X
A X
C Z
C Y
A Z
B Z
C Z
A Z
C Y
C Z
B X
C X
A Z
C Z
B Z
A X
B Y
C X
A X
B Y
C Z
B Z
C Z
C Y
A Z
C Z
B Z
C Z
C Z
A X
C Z
C Z
A Z
C X
C Z
A X
C Z
C Z
C Z
C Y
A X
B Z
B Z
A X
C Z
B Y
C Z
A X
C Y
B Z
C Z
A X
C Y
A Z
C X
B Y
C X
B Z
C Y
A Z
C X
C X
C Y
C X
A X
B Z
C X
C X
C X
B Z
B Y
B Z
C X
B Y
C Z
A X
C Z
A Z
C Y
C X
C Z
A Z
B Z
B Z
C X
A Z
A X
C Z
B X
A X
A X
B X
C X
C X
A Z
B Z
C Z
C X
B Z
A Z
A Z
C Z
C X
B Y
C X
C X
C X
C Z
C X
A X
C X
C Y
C Z
A X
C Y
B Z
B Z
A X
C Z
B Z
B Y
C Y
C X
A Z
B Y
A X
A Z
B Z
C X
B Z
A Z
C Y
C X
C X
C Z
B X
A X
C Z
C Z
C X
B Y
C Z
A Z
C Z
C Z
B Z
C X
C X
C Z
B Z
C Z
B Y
B Z
A X
B Z
A X
B Z
B Z
C Z
A Z
A X
A X
B Y
C Z
A Y
B Z
C Z
A Z
A Y
C Z
C Z
A X
C Y
C Z
C Z
A Z
C Y
C Z
A X
B Y
C Z
A X
B X
C X
A Z
C Z
A Z
C Y
C Z
C Y
A X
C X
B Z
B X
C Z
C Z
B Z
C Z
C Y
C X
B Z
A X
C Y
B Z
A Z
C Z
C X
B X
C Z
C Z
C Z
A X
C X
B X
C Y
A X
A Z
C X
C Y
C X
C X
A Z
A Z
C X
C X
C X
A X
A X
C X
A X
A X
A X
C Z
B Z
C Y
C Z
C Z
C X
C Y
A X
B Z
C Y
B Y
A X
A X
A Z
A Z
C Y
C Y
C X
C Z
A X
A X
C Z
C Z
B Z
B Z
C Z
A X
C X
C X
C X
A Z
C Z
A Z
B Y
B Y
C X
B Z
B Z
C Z
C Z
B Z
C Y
B Z
B X
B Z
C Z
A Z
A X
C X
A Y
C Z
A X
C X
A X
B X
C X
B Z
A X
C Z
B Z
C X
B Z
C Z
C X
A X
C Z
B Z
C Z
A Z
A X
A Z
C Z
C Z
B X
C Z
A Z
B Y
C Z
B X
B Z
C X
B X
A Z
C Z
C X
A Y
A X
C X
B Z
C X
C Y
C Y
C X
C Y
C Y
B X
B Z
A X
B Y
B Z
C Z
B Z
C Z
C Z
B Z
C X
C X
B Z
B Z
C X
C X
A X
C X
B Y
B X
C Z
B Z
A X
A Z
A Y
C Z
A Z
B Z
A Z
C X
C X
A Y
C X
B Z
B Y
B Y
C Z
B X
B Z
A X
B Y
C Z
C Z
A X
B Y
A Z
C Z
C Z
B Z
A Z
C Z
B Z
C Y
C X
B Z
A Z
A X
A X
A X
C Z
A Z
A X
C Y
C Y
B Z
C Z
B Y
C X
B Z
C X
B Z
B Y
C Z
A X
A X
B Z
A Z
B Z
C Z
C Z
A X
C X
C Z
A Z
A X
C Z
C X
B Z
C Z
A Z
C Z
B X
B Z
A X
C Z
C Z
A X
C X
A Z
C Z
A X
C Z
A Z
C X
C X
B Z
C Z
C X
B X
A X
B Z
B Y
B X
C Z
B X
B Z
C X
C Z
B Z
A Z
C Z
B Z
C Z
B X
B Y
C Z
C Y
C Z
B Y
B Z
C Z
A X
C X
C X
B Z
B Z
A X
A Y
A Z
C X
B X
C Z
C X
B Z
C X
A X
A X
B Z
B Y
B Z
B Y
C Y
C Z
B Z
C Y
B Z
C X
A X
B Y
C Z
A X
A X
C X
C Z
B Z
C Y
C Z
C X
C X
C Z
C X
B Z
C Y
C Z
A X
C X
B X
A X
B X
C X
C Z
A Z
A X
A Z
A X
A X
A X
A Y
A X
B Z
B Y
A X
C Z
A Z
C X
C Z
A Z
A Y
C Z
B Z
B Z
B Z
C X
A X
A X
C Z
C X
A X
C Z
C X
A X
C Y
B Z
C Z
C X
C X
C X
C Z
C X
C Y
B Y
C X
B Y
B Z
C X
C Z
A X
B Z
C Z
C X
A Y";
}